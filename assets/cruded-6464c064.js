import{g as f,w as c,i as fe,l as m,a as B,C as P,b as j,d as x,u as R,o as Le,e as qe,$ as L,c as k,t as Me,f as b,h as Z,j as de,k as Ae,m as $,n as q,p as H,q as he,r as _,s as E,v as me,x as De,y as ce,z as pe,A as _e,B as le,D as Q,E as W,F as A,G,H as Ce,I as F,J as Fe,K as Te,L as T,M as Y,N as He,O as Be,P as Ee,Q as Ve,R as Se,S as X,T as Ie,U as ze,V as Oe,W as Re,X as z,Y as ae,Z as ne,_ as Ne,a0 as y,a1 as Pe,a2 as oe,a3 as Ze,a4 as $e,a5 as Ke,a6 as ue,a7 as Ue,a8 as J}from"./shared-26237cc3.js";const O=(s,e,t)=>({tp:s,params:t,render:()=>e}),ge=()=>O("req",c.required);function ve(s,e){if(e)for(let t of e){let l=function(){this&&(i[this.name]=this.value),r(i,s)},i={},r=t.at(-1);for(let n=0;n<t.length-1;n++){let a=t[n],u=s.input(a);i[a]=u.value,u.onset(["value","off"],l)}setTimeout(l)}}class Je extends P{inputs;constructor(e,t){H(e)&&(t=e,e={}),super(e),this.inputs=Z(t),ve(this,e.bots)}view(){throw 1}get isDef(){for(let e of this.inputs)if(!e.isDef())return!1;return!0}input(e){for(let t of this.inputs)if(t.name==e||de(t,te)&&(t=t.input(e)))return t}errors={};setErrors(e,t){this.errors[e]=t,this.input(e)?.error(!!t)}valid(e,t=!e){if(e)return!this.inputs.some(i=>i.invalid(i.value,!0));for(let i of this.inputs){let r=i.invalid(i.value,e,t);this.setErrors(i.name,r),r&&t&&(i.focus(),t=!1)}return!Ae(this.errors,i=>i&&m(i))}focus(){for(let e of this.inputs)if(!e.p.off){e.focus();break}return this}fill(e,t){return this.emit("fill",e).inputs.forEach(i=>i.fill(e,t)),this}reset(...e){for(let t of m(e)?this.inputs.filter(i=>e.includes(i.name)):this.inputs)t.visited=!1,t.value=t.def;return this}data(e,t){let i=this.inputs,r=$({},this.p.hidden);for(let l of e?i.filter(n=>t&&n.p.req||!n.isDef()):i)l.p.off||l.submit(r,e,t);return this.emit("submit",r),r}formData(e,t){let i=new FormData,r=this.data(e,t);for(let l in r)i.append(l,r[l]);return i}}function je(s,e){let t=[];for(let i in e){let r=q(s,i,"name");t.push(e[i]?.map(l=>k([r&&[f("b",0,r.p.text),": "],l])))}return t}class ee extends Je{errDiv;constructor(e,t){super(e,t),this.errDiv=this.p.errorDiv||qe(),this.p.outline==null&&(this.p.outline=L.oform),this.inputs.forEach(this.addInput,this)}addInput(e){e.form=this,e.onset(["value","off"],()=>{e.visited&&this.setErrors(e.name,e.invalid(e.value));let t=e.field(this).attr("edited",!e.isDef());this.p.offFN?.(t,!!e.p.off),this.emit("input",e)}),e.observeVisited(t=>this.setErrors(t.name,t.invalid(t.value)))}view(){let{p:e,inputs:t}=this;return f(e.tag||"form","_ form",[t.map(i=>i.field(this)),this.errDiv])}setErrors(e,t){super.setErrors(e,t),this.errDiv.set(je(this.inputs,this.errors))}}function We(s,e,t,i=De(),r,l){return H(e)&&(e=new ee(e)),new Promise(n=>{he(s,f(e.set("tag","div"),"bd"),(a,u)=>[i.p({type:"submit"}).on("click",d=>{d.preventDefault(),e.valid()&&(_(d),E(u,async()=>{let v=e.data();n(await t?.(v,e)||v),a()}))}),r||me(()=>{a(),n(null)})],l,!r),e.focus()})}function Ge(s,e,t,i=t?.p?.labelSz){let r=x(t?.p.outline,e.outline),l=k("_ "+(r?"oi":"ii"),[(!r||e.text)&&f("label","hd",[e.text,e.tip&&Me(B(b.info),e.tip)]).css("width",`${i}%`).attr({for:e.name}),s=f(s,"bd").css("width",`${100-i}%`),!!e.req&&f("span","req","*")]);return e.off&&t?.p.offFN?.(s,!0),l}class K extends P{constructor(e){super(e),j(e.text)&&(e.text=x(c[e.name],R(e.name))),j(e.value)&&(e.value=this.def)}get name(){return this.p.name}get value(){return x(this.p.value,null)}set value(e){this.set("value",e)}fill(e,t){let i=this.p.name;i in e&&(this.value=e[i],t&&this.set("def",e[i]))}get def(){return x(this.p.def,this.null)}isDef(e=this.value,t=this.def){return t===e}isNull(e=this.value){return this.isDef(e,this.null)}visited;observeVisited(e){Le(f(this),()=>{this.visited=!0,e(this)})}error(e){return f(this).c("error",e),this}invalid(e,t,i){if(this.p.off)return null;let r=this.validate(e,t,i);return m(r)?r:null}validate(e){return this.p.req&&this.isNull(e)?[ge()]:[]}#e;field(e,t){return this.#e||=Ge(this,this.p,e,t)}submit(e){let{name:t,value:i,submit:r}=this.p;r?r(e):e[t]=i}get null(){return null}}class Xe extends K{view(){var e=this.p,t;return e.input=="ta"?t=f("textarea","_ in v").p({name:e.name,id:e.name,placeholder:e.ph||""}).on("keydown",i=>{i.key=="Enter"&&(i.ctrlKey?i.preventDefault():i.stopPropagation())}):t=f("input","_ in").p({type:e.input||"text",name:e.name,id:e.name,placeholder:e.ph||""}),t.on({input:()=>{this.emit("input",t.v()),this.set("value",t.v()||null)},focus(){t.e.select()}}),this.bind(t,()=>t.e.value=e.value||"","value")}validate(e){let t=this.p,i=[];return e?(t.pattern&&!t.pattern.test(e)&&i.push(O("invalid_format",c.invalidFmt)),t.max&&e.length>t.max&&i.push(O("text_too_long","",{max:t.max})),t.min&&e.length<t.min&&i.push(O("text_too_short","",{min:t.min}))):t.req&&i.push(ge()),i}}class Qe extends K{options;get active(){return q(this.options,this.p.value,this.options.key)}constructor(e,t,i=0){super(e),e.item||=r=>x(r[1],r[i]),this.options=ce(t,{key:i,parse:r=>pe(r)?r:{[i]:r}})}get value(){return this.p.value}set value(e){this.p.value===e||this.set("value",e)}view(){let{p:e,options:t}=this,i=f("span"),r=f("table").on("click",({currentTarget:a,target:u})=>a!=u&&(this.set("open",!1).value=f(u).closest("tr").d())),l=k("_ menu",r),n=_e(this,t,i,l,a=>this.value=a).attr({name:e.name});return le(this,i),this.on(a=>"value"in a&&le(this,i)),t.bind(r,{insert:a=>Q(a.i,e.item(a)).d(a[t.key]),tag(a,u,d,v){let w=d.child(u);w.c(v,a),a&&l.e.scroll({top:w.p("offsetTop")-l.p("clientHeight")/2+w.p("clientHeight")/2})}}),n}option(e){return this.options.find(e)}}class Ye extends K{view(){let e=this.p,t=e.options.map(i=>fe(i)?[i]:i);return e.layout||=m(t)>3?"column":"wrap",this.bind(f("span",e.layout=="column"?"_ col":"",t.map(([i,r,l])=>f("label","cb",[f("input",{type:"radio",value:i,name:e.name,checked:i==e.value,oninput:()=>{this.set("value",i)}}),l&&B(l),r||i]))).on("click",i=>{i.altKey&&(f(i.currentTarget).queryAll("input").p("checked",!1),this.set("value",null))}),i=>{i.queryAll("input").forEach(r=>{r.checked=r.value==e.value})},"value").css("position","relative")}}class te extends K{#e;get form(){return this.#e}set form(e){this.#e=e;for(let t of this.inputs)t.form=e}constructor(e,t){e.value=null,super(e);for(let i of this.inputs=Z(t))i.onset(["value","off"],()=>{let r=f(i).attr("edited",!i.isDef());this.form.p.offFN?.(r,!!i.p.off),this.set(["value"])});ve(this,e.bots)}inputs;get def(){return W(this.inputs,e=>[e.name,e.def])}get value(){return W(this.inputs,e=>[e.name,e.value])}set value(e){this.inputs.forEach(t=>t.name in e&&(t.value=e?e[t.name]:t.null))}view(){for(let e of this.inputs)e.onset("value",()=>this.set(["value"]));return f("span","_ join",this.inputs)}fill(e,t){if(!(this.p.sub&&!(e=e[this.p.name])))for(let i of this.inputs)i.fill(e,t)}validate(e,t,i){let r=[];for(let l of this.inputs){let n=l.invalid(l.value,t,i);n&&r.push(...n),n&&i&&(l.focus(),i=!1)}return r}focus(){return this.inputs[0]?.focus(),this}submit(e,t,i){let{inputs:r,p:l}=this;l.sub&&(e=e[l.name]=l.sub=="array"?[]:{});for(let n of t&&!l.sub?r.filter(a=>i&&a.p.req||!a.isDef()):r)n.p.off||n.submit(e,t,i)}input(e){for(let t of this.inputs)if(t.name==e||de(t,te)&&(t=t.input(e)))return t}isDef(e=this.value,t=this.def){for(let i of this.inputs)if(!i.isDef(e[i.name],t[i.name]))return!1;return!0}}class et extends P{view(){let e=this.p,t,i=f("span"),r;if(e.setlimit)var l=new Qe({value:e.limit,fluid:!0,clear:!1},[e.min,e.min*5,e.min*10,e.min*10,e.min*20,[0,c.showAll]]);return this.bind(k("_ bar pag",[e.extreme&&T(b.first,null,()=>this.set("pag",1)),T(b.prev,null,()=>this.set("pag",e.pag-1)),f("span","hd").css({textAlign:"center"}),T(b.next,null,()=>this.set("pag",e.pag+1)),e.extreme&&T(b.last,i,()=>this.set("pag",t)),l&&[f("hr"),f(l.onset("value",({value:n})=>{this.set("limit",n)}),"i")],f("hr"),r=f("span","hd")]),n=>{r.set(`${Math.min(e.total-e.limit*(e.pag-1),e.limit||e.total)||0} / ${e.total||0}`),t=e.limit?Math.ceil((e.total||0)/e.limit):1,n.c("off",!!(t<2&&e.hideOnSingle));let a=e.extreme?0:1;n.child(2-a).set(e.pag),n.childs(0,2-a).p("disabled",e.pag==1),n.childs(3-a,5-a*2).p("disabled",e.pag==t),i.set(t)})}get pags(){let{limit:e,total:t}=this.p;return e?Math.ceil((t||0)/e):1}}function tt(s,e,t=e){let i=new et({pag:s.pag,min:s.limit,limit:s.limit,extreme:t,setlimit:e}).on(r=>{"pag"in r&&(s.pag=r.pag,"limit"in r||s.update()),"limit"in r&&(s.limit=r.limit)});return s.on(([r])=>i.set({total:r,limit:s.limit,pag:s.pag})),i}class it extends P{get cols(){return this.p.cols}data;form;constructor(e,t){super(e),this.data=ce(t,{g:e.single?null:["on"],key:e.key,clear:!0}),e.head||=i=>x(x(i.text,c[i.key]),R(i.key))}ccss(e,t,i=1){let r=0;if(Re(t)){let l=this.cols,n=t,a=0;for(t=l[t];a<i;a++)r+=l[n+a].size}else r=t.size;return e.c("i").css({width:r+"px",textAlign:t.align})}view(){let e=this.p,t=e.cols,i=e.allColumns,r=e.reqColumns,l=this.data,n,a=i&&Y(null,i.map(o=>X(t.includes(o),x(x(o.text,c[o.key]),R(o.key)),h=>{h?(t.push(o),t.sort((p,g)=>i.indexOf(p)-i.indexOf(g))):t.remove(o)},o.key,r&&r.includes(o.key)))).on("click",o=>_(o)),u=t.bind(k("hd _ tr",z(e.corner,"sd")),{insert:(o,h,p)=>{let g=this.ccss(z(e.head(o),"i"),o).uncss("textAlign");e.resize&&k("div").addTo(g).on("mousedown",S=>{_(S);let M=t.indexOf(o)+1;if(!e.fill||M<m(t)){let se=function(re){if(o.size=o.size=Math.max(L.rem*2,re.clientX-g.rect.left),ie.css({width:o.size+"px"}),U){let be=t[M].size=Math.max(L.rem*2,ke-re.clientX);U.css({width:be+"px"})}},ie=w.childs().child(M),U=e.fill&&ie.next(),xe=U?.e?.(0),ke=xe?.rect?.right;ae().css({cursor:"col-resize",userSelect:"none"}),ne().on("mousemove",se).one("mouseup",()=>{ne().off("mousemove",se),ae().uncss("cursor","userSelect")})}}),e.sort&&g.on("click",()=>{t.tag("sort")==o?o.desc?(o.desc=!1,t.tag("sort",null)):(o.desc=!0,t.retag("sort")):(o.desc=!1,t.tag("sort",o))}),a&&g.on({mouseenter(){clearTimeout(n),g.add(a)},mouseleave(){n=setTimeout(()=>a.remove().child(".menu")?.remove(),300)}}),p.place(h+1,g)},tag(o,h,p,g,S){let M=p.child(h+1);switch(g){case"sort":M.child(".sort")?.remove(),o&&M.add(B(b[S.desc?"desc":"asc"]).c("sort")),e.sort.call(S,o);break;default:M.c(g,o)}},remove(o,h,p){p.unplace(h+1)},clear(o){o.childs(1).remove()}}),d=o=>f(o(this),"_ ft tr"),v=e.foot&&Ne(...e.foot.map(d)),w=k("_ tb",[u,v]).on("click",o=>o.target==o.currentTarget&&y.clear(l,"on")).p("tabIndex",0).on("keydown",o=>{lt(l,o,e)&&_(o)}),V=o=>[k("sd"),t.map(h=>this.ccss(z(h.fmt?h.fmt(o[h.key],e.p,o):o[h.key]),h))];return l.bind(w,{insert:(o,h)=>{let p=k("_ tr i",V(o));w.place(h+1,rt(e.style?.(p,o,h)||p,o,l,e))},reload(o,h){w.child(h+1).set(V(o))},tag:(o,h,p)=>{let g=p.child(h+1).c("crt",o).e;o&&g.scrollIntoView({block:"nearest",inline:"nearest"})},remove(o,h,p){p.unplace(h+1)},clear(o){o.childs().slice(1).remove()},groups(o,h,p,g){p.child(h+1).c(g,o)}}),t.on(()=>{this.data.reloadAll(),v?.eachS((o,h)=>o.replace(d(e.foot[h])))}),e.resize&&w.c("brd"),w}fillArea(e=2*L.rem){let t=this.p.cols,i=f(this),r=i.childs();console.log(e,i.e.clientWidth),st(t,i.e.clientWidth-2-e);for(let l=0;l<m(t);l++)r.child(l+1).css({width:t[l].size+"px"})}}function st(s,e=100){let t=0,i=s.length,r=[];for(let l of s){let n=l.size||1/i;r.push(n),t+=n}for(let l=0;l<i;l++)s[l].size=r[l]/t*e}function rt(s,e,t,i){let r=l=>y.add(t,"on",e,y.tp(l.ctrlKey,l.shiftKey));return s.on({click:r,dblclick:i.open&&(()=>i.open(...y.list(t,"on"))),contextmenu:i.menu&&(l=>{r(l);let n=i.menu(y.list(t,"on"));n&&Pe(l,n)})})}const D=(s,e,{ctrlKey:t,shiftKey:i})=>i?y.move(s,"on",e,y.tp(t,!1)):t?y.movePivot(s,"on",e):y.move(s,"on",e,"set");function lt(s,e,t,i){switch(e.key){case"Delete":let r=y.list(s,"on");if(r.length&&t.remove)(async()=>{if(await t.remove(r)!==!1)for(let l of r)s.remove(l)})();else return;break;case"Home":D(s,-y.pivot(s,"on"),e);break;case"End":D(s,s.length-y.pivot(s,"on"),e);break;case"PageDown":D(s,10,e);break;case"PageUp":D(s,-10,e);break;case"Enter":if(t.open){t.open(...y.list(s,"on"));break}else return;case"ArrowUp":if(i)return;D(s,-1,e);break;case"ArrowDown":if(i)return;D(s,1,e);break;default:return}return!0}class at{#e;#t;#i;list;readOnly;length;task;fromStorage;toStorage;src;all;groupBy;sort;queryBy;fields;w;constructor(e,t={}){H(t)&&(t={fields:t}),this.src=e,this.#i=x(t.limit,L.defLimit),this.#t=t.pag||1;let i=()=>{this.#t=1,this.update(!0)};this.query=t.query,this.sort=F(t.sort,{parse:r=>fe(r)?[r]:r,key:0}).on(i),this.fields=F(t.fields||Z(e.fields.map(r=>A(r.get)&&r.name)),r=>{if(!q(e.fields,r,"name"))throw Be(r,"field",e);return r}).on(()=>this.update(!0)),this.queryBy=F(t.queryBy||e.fields.filter(r=>r.query).map(r=>r.name)).on(i),this.w=H(t.where)?W(t.where,(r,l)=>[l,r]):t.where}get pags(){return this.#i?Math.ceil(this.length/this.#i):1}get query(){return this.#e}set query(e){e!=this.#e&&(this.#t=1,this.#e=e,this.update(!0))}get pag(){return this.#t}set pag(e){e<1?e=1:e>this.pags&&(e=this.pags),this.#t!=e&&(this.#t=e,this.update())}get limit(){return this.#i}set limit(e){this.#i!=e&&(this.#t=e?Math.ceil(this.#i*this.#t/e):1,this.#i=e,this.update())}ids(){let e=this.src;if(this.pags>1){let t=this.toJSON();return e.get({tp:"col",fields:[e.id],where:t.where,query:t.query,queryBy:t.queryBy})}else return this.list.map(t=>e.id||t.id)}where(e,t){return(this.w||={})[e]!==t&&(t?this.w[e]=t:delete this.w[e],this.update(!0)),this}bind(e){if(!this.list){let t=this.src;(this.list=H(e)?e:F(e)).key=t.id,(t.bonds||=[]).push(new WeakRef(this)),this.update()}return this.list}getAll(e="rows"){return this.src.get($(this.toJSON(),{tp:e,limit:void 0,pag:void 0}))}#s;#r;update(e){let t=async()=>{let i={},r={},l=this.list,n=this.#l;if(l||n){let a=this.src,u=await(this.task=a.get(this.toJSON(),(this.#s=new AbortController).signal));if(this.task=this.#s=null,this.length=u[0],l){for(let d in l.tags)l.tags[d]&&(i[d]=l.tags[d].v[a.id]);for(let d in l.g)r[d]=l.g[d].keyField();l.set(u[1]);for(let d in i)l.tag(d,i[d]);for(let d in r){let v=r[d];l.g[d].set(l.filter(w=>v.indexOf(w[a.id||"id"])!=-1))}}if(n)for(let d of n)d(u);return u}};return this.#s?.abort(),clearTimeout(this.#r),this.task=null,e?(this.#r=setTimeout(t),this):t()}#l;on(e){return(this.#l||=[]).push(e),this}toJSON(){let{query:e,queryBy:t,fields:i,w:r,sort:l,src:n,limit:a,pag:u}=this;return{tp:"full",fields:!m(i)||m(n.fields)==m(i)?void 0:i.map(d=>{let v=q(n.fields,d,"name").exp;return v?[d,v]:d}),where:r&&Object.values(r),limit:a,pag:u==1?void 0:u,query:e||void 0,queryBy:e&&m(t)?t:void 0,sort:l.length?l:void 0}}}const nt=s=>f("label","_ in",[Ee(f("input",{type:"search",name:`${s.src}_search`,value:s.query||"",placeholder:c.search+"..."}),"input",500,function(){s.query=this.value}),Ve(b.search,null,()=>s.update())]);function ot({queryBy:s,src:e}){let t=e.fields.filter(r=>r.query);if(!t.length)return null;let i=Se([X(m(t)==m(s)?!0:m(s)?null:!1,c.all,r=>s.set(r&&t.map(l=>l.name)),"all"),Ie(),...t.map(r=>X(s.includes(r.name),x(r.text,R(r.name)),l=>l?s.push(r.name):s.remove(r.name),r.name))]);return s.on(()=>{i.query("#all").p({checked:m(t)==m(s),indeterminate:m(s)&&m(t)!=m(s)});for(let r of i.queryAll("input:not(#all)"))r.checked=s.includes(r.id)}),Y(null,()=>i)}function ut(s,e){let t=s.bind(),i=f("input",{type:"checkbox"}).on("input",()=>{i.p("checked")?(y.addAll(t,"on"),i.p({checked:!0,indeterminate:!1}),s.all=void 0,E(f(e),async()=>{let r=await s.getAll();j(s.all)&&(s.all=r)},null,250)):y.clear(t,"on")});return y.onchange(t,"on",(r,l)=>{s.all=null,i.p({checked:!!r,indeterminate:!!r&&(s.pags>1||(l?l.length<t.length:t.length>1))})}),i}const ft={null:()=>k(0,B(b.null)),invalidIcon:()=>B("image-broken"),checkboxFmt:"icon",wrap:z,html:!0,interactive:!0,format:!0};function dt(s,e={}){let t=s.src,i=t.fields.filter(u=>A(u.get)),r=i.map(u=>({dt:u.dt,key:u.name,text:u.text,size:(u.size||10)*L.rem,align:u.align,fmt:u.out?.bind(u)}));m(s.fields)||s.fields.set(G(i,"name"));let l=F(s.fields.map(u=>q(r,u,"key")));ze(l,s.fields,!1,u=>u.key);let n=f("span"),a=new it({cols:l,fill:e.fill,resize:!0,single:e.single,style:e.style||t.style,p:e.p||ft,corner:n,menu:e.menu&&(u=>e.menu(s.all||u,s,a)),open:u=>ye(t,u?.id),remove:u=>we(t,G(u,t.id||"id")),allColumns:r,reqColumns:e.req||[t.main],key:t.id||"id",sort:{clear:!0,call({key:u,desc:d},v){s.sort.set(v&&[[u,d]])}}},s.bind());return n.add(ut(s,f(a))),a}async function ht(s,e){return s.mdform?s.mdform():(e||=s.form?await s.form(s):new ee(s.fields.map(t=>t.set&&t.in())),We([0,N(c.newItemTitle,{src:s.s})],e,t=>s.post([t])))}async function ye(s,e,t){let i=await s.get({tp:"row",where:[`${s.id}='${e}'`],src:!0});if(s.mdform)return s.mdform(i);he([0,N(c.editItemTitle,{src:s.s,item:f("strong",0,i[s.main])})],(t||=s.form?await s.form(s,!0):new ee(s.fields.map(r=>x(r.edit,r.set)&&r.in()))).set("tag","div").fill(i,!0),(r,l)=>[oe(c.save,async n=>{_(n),t.valid()&&await E(l,()=>s.put([$(t.data(!0),{id:e})])),r()},"submit").c("accept"),s.post&&oe(c.duplicate,async n=>{_(n),t.valid()&&await E(l,()=>s.post([t.data()])),r()},"submit"),me(r)]),t.focus()}function N(s,e){if(s){let t=[],i=/{(\w+)}/g,r,l=0;for(;r=i.exec(s);)t.push(s.slice(l,l=r.index),e[r[1]]),l+=m(r[0]);return t.push(s.slice(l,m(s))),Z(t)}}async function we(s,e){let t=m(e),i=e[0]?.[s.main];await Oe(t==1&&i?N(c.confirmRemove,{src:s.s,item:f("strong",0,i)}):N(c.confirmRemoveMany,{src:t==1?s.s:s.p,count:t}))&&await s.del(e.map(r=>pe(r)?r[s.id]:r))}function mt(s,e){return Q(b.remove,c.remove,()=>we(s,e),L.sc?.remove,!m(e)||!s.del)}function ct(s,e){return Q(b.edit,c.edit,()=>ye(s,e[0][s.id]),L.sc?.edit,m(e)!=1||!s.put)}function pt(s,{src:e}){return[ct(e,s),mt(e,s)]}async function gt(s,e={}){let t=s.src,i=dt(s,{menu:Fe(e.menu)?e.menu:pt,single:e.single});return[k("_ bar",[nt(s),ot(s),Te(),await e.options?.(s,i),A(e.add)&&t.post&&T(b.plus,`${c.add} ${t.s||""}`,()=>ht(t)).id("add"),e.more&&Y(null,e.more,"vs")]),f(i).css("flex",1),f(tt(s,!0),0,[f("hr","r"),e.totals&&(()=>{let r=k("_ bar",e.totals);return s.on(()=>r.set(e.totals)),r})()])]}const C=(s,{req:e,def:t,text:i,query:r,input:l,set:n}={})=>({name:s,set:A(n),text:i,in:()=>new Xe({name:s,input:l,req:e,def:t,text:i}),query:A(r)}),vt=(s,e,{req:t,def:i,text:r,set:l,query:n}={})=>({name:s,set:A(l),text:r,in:()=>new Ye({name:s,req:t,def:i,text:r,options:e}),query:A(n),out:(a,u)=>a==null?u.null:q(e,a,0)[1]});function yt(s,e,t="id",i=t=="id"){let r=1;return{src:s,id:t,fields:e,get(l){return new Promise(n=>{let a=s;if(l.where?.length&&(a=s.filter(d=>!0)),l.sort){a===s&&(a=a.slice());for(let d of l.sort){let[v,w]=He(d),V=w?1:-1;a.sort((o,h)=>{let p=o[v],g=h[v];return p==g?0:(p>g?1:-1)*V})}}let u=m(a);if(l.limit){let d=l.pag||1;a=a.slice((d-1)*l.limit,d*l.limit)}switch(l.tp||"rows"){case"full":n([u,a]);break;case"rows":n(a);break;case"col":n(G(a,l.fields[0]));break;case"row":n(a[0]);break;case"one":n(x(a[0]?.[l.fields[0]],null));break;default:throw"not supported"}})},post(l){let n=Array(m(l));for(let a of l){if(a[t]==null)if(i)a[t]=r++;else throw"invalid";if(q(s,a[t],t))throw"invalid";n.push({[t]:a[t]}),s.push(a)}return n},put(l){for(let n of l){let a=q(s,n.id,t);if(a)for(let u in n)a[u]=n[u];else console.warn(`item of id '${n.id}' not found`)}},del(l){for(let n of l){let a=Ce(s,n,t);a!=-1&&s.splice(a,1)}}}}$(b,{plus:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",prev:"M14,7L9,12L14,17V7Z",next:"M10,17L15,12L10,7V17Z",first:"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z",last:"M16,18H18V6H16M6,18L14.5,12L6,6V18Z",dd:"M7,10L12,15L17,10H7Z",search:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z",edit:"M18.62,1.5C18.11,1.5 17.6,1.69 17.21,2.09L10.75,8.55L14.95,12.74L21.41,6.29C22.2,5.5 22.2,4.24 21.41,3.46L20.04,2.09C19.65,1.69 19.14,1.5 18.62,1.5M9.8,9.5L3.23,16.07L3.93,16.77C3.4,17.24 2.89,17.78 2.38,18.29C1.6,19.08 1.6,20.34 2.38,21.12C3.16,21.9 4.42,21.9 5.21,21.12C5.72,20.63 6.25,20.08 6.73,19.58L7.43,20.27L14,13.7",remove:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",asc:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",desc:"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"});Ze({pt:{hi:"Ola, meu nome é",fname:"Primeiro Nome",lname:"Ultimo Nome",addr:"Endereço",add:"Adicionar",gender:"Género",genderF:"Femenino",genderM:"Masculino",confirm:"Confirmar",cancel:"Cancelar",crudTitle:"CRUD simples com suporte para inserção, modificição e remosão de dados",required:"Obrigatorio",edit:"Editar",remove:"Remover",save:"Salvar",search:"Pesquisar",duplicate:"Duplicar"},en:{hi:"Hi, my name is",fname:"First Name",lname:"Last Name",addr:"Address",add:"Add",search:"Search",cancel:"Cancel",confirm:"Confirm",required:"Required",crudTitle:"Simple crud with suport to add, edit and remove.",gender:"Género",genderF:"Female",genderM:"Male",edit:"Edit",remove:"Remove",save:"Save",duplicate:"Duplicate"}});const wt=yt($e,[C("fname",{req:!0,text:c.fname}),C("lname",{req:!0,text:c.lname}),C("email",{input:"email"}),C("tel",{input:"tel"}),vt("gender",[["F",c.genderF],["M",c.genderM]],{text:c.gender}),C("addr",{text:c.addr})]),I=(s,e)=>f("a","_ link",e).p("href",s);Ke("cruded",[f("h2",[c.crudTitle]),E(()=>gt(new at(wt,{limit:10}))),f("h3",{id:"install"},J("Instalation","Instalação")),f("p",0,"npm i cruded"),f("h3",{id:"funcs"},J("Functionalities","Funcionalidades")),ue("generate list for pagination","search input","contextmenu per item","diferent field types",["support diferent data source",ue([I("#fromArray","fromArray")," get data from simple array"],[I("#fromIDB","fromIDB")," get data from IndexedDB (todo)"],[I("#fromFetch","fromFetch")," get data from url `REST API` using fetch API"],[I("#fromMethods","fromMethods")," get data from custom methods"])],"generate form for insert and update data"),f("h3",{id:"sample"},J("Sample","Exemplo")),Ue(`
import { crud, fromArray, fText,fRadio } from "cruded";
import { get } from "galho";

const list = [
  { id: 1, fname: "Bobette", lname: "Oldroyde",  gender: "F", tel: "508-974-4484", addr: "Room 1396"  },
  { id: 2, fname: "Quincey", lname: "Livermore", gender: "M", tel: null,           addr: null         },
  { id: 3, fname: "Billye",  lname: "Boutcher",  gender: "F", tel: "472-985-4634", addr: "7th Floor"  },
  { id: 4, fname: "Ardine",  lname: "Bontine",   gender: "F", tel: "620-502-4286", addr: "Suite 63"   },
  { id: 5, fname: "Clayton", lname: "Dunkley",   gender: "M", tel: "698-922-1909", addr: "16th Floor" },
];

//create datasource from array
const src = fromArray(list, [
  fText("fname", { req: true, text: w.fname }),
  fText("lname", { req: true, text: w.lname }),
  fText("tel", { input: "tel" }),
  fRadio("gender", [["F", w.genderF], ["M", w.genderM]], { text: w.gender }),
  fText("addr", { text: w.addr }),
]);

//create bond to datasource, limit:10 define number of item per pag
const bond=new Bond(src, { limit: 10 });

//render crud component, limit
const myCrud = crud(bond);

//add crud to document.body
get("body").add(myCrud);`)]);
